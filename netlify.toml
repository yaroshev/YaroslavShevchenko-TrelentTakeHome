[build]
  base = "web"
  # Netlify's default dependency install step may omit optional deps; Tailwind v4
  # requires lightningcss's platform package (Linux) which is an optional dep.
  # Running `npm ci --include=optional` here ensures the native binding is present.
  command = "npm ci --include=optional --no-audit --no-fund && npm run build"
  publish = ".next"

[[plugins]]
  package = "@netlify/plugin-nextjs"

[build.environment]
  NODE_VERSION = "20"
  NPM_FLAGS = "--include=optional"
  NPM_CONFIG_OPTIONAL = "true"

